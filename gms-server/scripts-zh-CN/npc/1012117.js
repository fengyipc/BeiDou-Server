/*
    This file is part of the OdinMS Maple Story Server
    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>
               Matthias Butz <matze@odinms.de>
               Jan Christian Meyer <vimes@odinms.de>

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as
    published by the Free Software Foundation version 3 as published by
    the Free Software Foundation. You may not use, modify or distribute
    this program under any other version of the GNU Affero General Public
    License.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/
/* 	
    NPC Name: 		Big Headward
        Map(s): 		Victoria Road : Henesys Hair Salon (100000104)
    Description: 		Random haircut

        GMS-like revised by Ronan -- contents found thanks to Mitsune (GamerBewbs), Waltzing, AyumiLove
*/

var status = 0;

// var mhair_v = Array(30010, 30070, 30080, 30090, 30100, 30480, 30560, 30690, 30760, 30850, 30890, 30930, 30950);
var mhair_v = [
    30000,
    30010,
    30020,
    30030,
    30040,
    30050,
    30060,
    30070,
    30080,
    30090,
    30100,
    30110,
    30120,
    30130,
    30140,
    30150,
    30160,
    30170,
    30180,
    30190,
    30200,
    30210,
    30220,
    30230,
    30240,
    30250,
    30260,
    30270,
    30280,
    30290,
    30300,
    30310,
    30320,
    30330,
    30340,
    30350,
    30360,
    30370,
    30380,
    30400,
    30410,
    30420,
    30430,
    30440,
    30450,
    30460,
    30470,
    30480,
    30490,
    30510,
    30520,
    30530,
    30540,
    30550,
    30560,
    30570,
    30580,
    30590,
    30600,
    30610,
    30620,
    30630,
    30640,
    30650,
    30660,
    30670,
    30680,
    30690,
    30700,
    30710,
    30720,
    30730,
    30740,
    30750,
    30760,
    30770,
    30780,
    30790,
    30800,
    30810,
    30820,
    30830,
    30840,
    30850,
    30860,
    30870,
    30880,
    30890,
    30900,
    30910,
    30920,
    30930,
    30940,
    30950,
    30960,
    30970,
    30990,
    33000,
    33010,
    33020,
    33030,
    33040,
    33050,
    33070,
    33100,
    33110,
    33120,
    33130,
    33140,
    33150,
    33160,
    33170,
    33180,
    33190,
    33210,
    33220,
    33240,
    33250,
    33260,
    33270,
    33280,
    33290,
    33310,
    33320,
    33330,
    33340,
    33350,
    33360,
    33370,
    33380,
    33390,
    33400,
    33410,
    33430,
    33440,
    33450,
    33460,
    33470,
    33480,
    33500,
    33510,
    33520,
    33530,
    33540,
    33550,
    33580,
    33590,
    33600,
    33610,
    33620,
    33630,
    33640,
    33660,
    33670,
    33680,
    33690,
    33700,
    33710,
    33720,
    33730,
    33740,
    33750,
    33760,
    33770,
    33780,
    33790,
    33800,
    33810,
    33820,
    33830,
    33930,
    33940,
    33950,
    33960,
    33990,
    35000,
    35010,
    35020,
    35040,
    35050,
    35060,
    35070,
    35080,
    35090,
    35100,
    35110,
    35120,
    35130,
    35140,
    35150,
    35160,
    35170,
    35180,
    35190,
    35200,
    35210,
    35220,
    35240,
    35260,
    35280,
    35290,
    35300,
    35310,
    35330,
    35340,
    35350,
    35360,
    35430,
    35440,
    35450,
    35460,
    35470,
    35490,
    35500,
    35510,
    35520,
    35530,
    35550,
    35590,
    35620,
    35640,
    35650,
    35660,
    35680,
    35690,
    35720,
    35740,
    35790,
    35950,
    35960,
    35980,
    35990,
    36000,
    36010,
    36020,
    36030,
    36040,
    36050,
    36060,
    36070,
    36080,
    36090,
    36100,
    36110,
    36130,
    36140,
    36150,
    36160,
    36170,
    36180,
    36190,
    36200,
    36210,
    36220,
    36230,
    36240,
    36250,
    36260,
    36270,
    36280,
    36300,
    36310,
    36330,
    36340,
    36350,
    36380,
    36390,
    36400,
    36410,
    36420,
    36450,
    36460,
    36470,
    36480,
    36490,
    36500,
    36510,
    36520,
    36530,
    36560,
    36570,
    36590,
    36600,
    36610,
    36630,
    36640,
    36650,
    36670,
    36680,
    36690,
    36700,
    36720,
    36740,
    36750,
    36760,
    36770,
    36780,
    36790,
    36800,
    36810,
    36820,
    36830,
    36840,
    36850,
    36860,
    36870,
    36880,
    36890,
    36900,
    36910,
    36920,
    36930,
    36940,
    36950,
    36960,
    36980,
    39260,
    39340,
    40000,
    40010,
    40020,
    40030,
    40040,
    40050,
    40060,
    40070,
    40080,
    40090,
    40100,
    40110,
    40120,
    40260,
    40270,
    40280,
    40290,
    40300,
    40310,
    40320,
    40360,
    40370,
    40390,
    40400,
    40410,
    40420,
    40440,
    40450,
    40460,
    40470,
    40480,
    40490,
    40500,
    40510,
    40530,
    40540,
    40550,
    40560,
    40570,
    40580,
    40590,
    40610,
    40620,
    40630,
    40640,
    40680,
    40700,
    40730,
    40740,
    40750,
    40780,
    40790,
    40800,
    40810,
    40820,
    40830,
    40840,
    40890,
    40910,
    42100,
    43000,
    43010,
    43020,
    43120,
    43130,
    43140,
    43150,
    43170,
    43180,
    43190,
    43200,
    43230,
    43240,
    43250,
    43260,
    43270,
    43320,
    43330,
    43350,
    43420,
    43580,
    43630,
    43650,
    43660,
    43680,
    43690,
    43730,
    43740,
    43750,
    43800,
    43820,
    43830,
    43870,
    43880,
    43890,
    43900,
    43910,
    45000,
    45020,
    45030,
    45050,
    45060,
    45070,
    45080,
    45090,
    45100,
    45110,
    45120,
    45130,
    45150,
    45160,
    45220,
    45230,
    45280,
    45310,
    45320,
    45340,
    45360,
    45370,
    45430,
    45440,
    45450,
    45460,
    45470,
    45480,
    45490,
    45510,
    45520,
    45570,
    45620,
    45640,
    45680,
    45740,
    45760,
    45770,
    45780,
    45840,
    45850,
    45860,
    45870,
    45880,
    45890,
    45900,
    45910,
    45920,
    45930,
    45940,
    46010,
    46020,
    46060,
    46070,
    46080,
    46110,
    46160,
    46170,
    46180,
    46200,
    46210,
    46220,
    46230,
    46240,
    46320,
    46340,
    46370,
    46380,
    46390,
    46400,
    46410,
    46420,
    46440,
    46450,
    46460,
    46470,
    46480,
    46490,
    46500,
    46510,
    46570,
    46610,
    46640,
    46680,
    46710,
    46760,
    46780,
    46800,
    46810,
    46820,
    46830,
    46840,
    46850,
    46860,
    46870,
    46880,
    46890,
    46900,
    46910,
    46920,
    46930,
    46940,
    46950,
    46960,
    46970,
    46980,
    60000,
    60020,
    60060,
    60070,
    60080,
    60100,
    60110,
    60120,
    60170,
    60180,
    60190,
    60200,
    60210,
    60220,
    60230,
    60240,
    60250,
    60260,
    60270,
    60280,
    60290,
    60300,
    60310,
    60320,
    60330,
    60340,
    60350,
    60360,
    60370,
    60380,
    60390,
    60400,
    60420,
    60430,
    60480,
    60490,
    60500,
    60510,
    60520,
    60530,
    60540,
    60550,
    60680,
    60920,
    60930,
    63080,
    63180,
    63190,
    63200,
    63210,
    63270,
    63280,
    63290,
    63300
  ];
var fhair_v = [
    31000,
    31010,
    31020,
    31030,
    31040,
    31050,
    31060,
    31070,
    31080,
    31090,
    31100,
    31110,
    31120,
    31130,
    31140,
    31150,
    31160,
    31170,
    31180,
    31190,
    31200,
    31210,
    31220,
    31230,
    31240,
    31250,
    31260,
    31270,
    31280,
    31290,
    31300,
    31310,
    31320,
    31330,
    31340,
    31350,
    31360,
    31400,
    31410,
    31420,
    31430,
    31440,
    31450,
    31460,
    31470,
    31480,
    31490,
    31510,
    31520,
    31530,
    31540,
    31550,
    31560,
    31570,
    31580,
    31590,
    31600,
    31610,
    31620,
    31630,
    31640,
    31650,
    31660,
    31670,
    31680,
    31690,
    31700,
    31710,
    31720,
    31730,
    31740,
    31750,
    31760,
    31770,
    31780,
    31790,
    31800,
    31810,
    31820,
    31830,
    31840,
    31850,
    31860,
    31870,
    31880,
    31890,
    31910,
    31920,
    31930,
    31940,
    31950,
    31960,
    31970,
    31990,
    32050,
//    32150,
    32160,
    32310,
    32320,
    32330,
    32340,
    32350,
    32360,
    32370,
    32380,
    32390,
    32400,
    32410,
    32420,
    32430,
    32440,
    32450,
    32460,
    32470,
    32480,
    32490,
    32500,
    32510,
    32520,
    32530,
    32540,
    32550,
    32560,
    32640,
    34000,
    34010,
    34020,
    34030,
    34040,
    34050,
    34060,
    34070,
    34080,
    34110,
    34120,
    34130,
    34140,
    34150,
    34160,
    34170,
    34180,
    34190,
    34210,
    34220,
    34230,
    34240,
    34250,
    34260,
    34270,
    34290,
    34310,
    34320,
    34330,
    34340,
    34350,
    34360,
    34370,
    34380,
    34400,
    34410,
    34420,
    34430,
    34440,
    34450,
    34470,
    34480,
    34490,
    34510,
    34540,
    34560,
    34580,
    34590,
    34600,
    34610,
    34620,
    34630,
    34640,
    34650,
    34660,
    34670,
    34680,
    34690,
    34700,
    34710,
    34720,
    34730,
    34740,
    34750,
    34760,
    34770,
    34780,
    34790,
    34800,
    34810,
    34820,
    34830,
    34840,
    34850,
    34860,
    34870,
    34880,
    34890,
    34900,
    34910,
    34940,
    34950,
    34960,
    34970,
    34980,
    37000,
    37010,
    37020,
    37030,
    37040,
    37050,
    37060,
    37070,
    37080,
    37090,
    37100,
    37110,
    37120,
    37130,
    37140,
    37150,
    37160,
    37170,
    37190,
    37200,
    37210,
    37220,
    37230,
    37240,
    37250,
    37260,
    37270,
    37300,
    37310,
    37320,
    37330,
    37340,
    37350,
    37370,
    37380,
    37400,
    37420,
    37440,
    37450,
    37460,
    37470,
    37490,
    37500,
    37510,
    37520,
    37530,
    37560,
    37570,
    37580,
    37590,
    37600,
    37610,
    37640,
    37660,
    37670,
    37690,
    37700,
    37710,
    37720,
    37750,
    37800,
    37810,
    37820,
    37830,
    37840,
    37850,
    37860,
    37880,
    37900,
    37920,
    37930,
    37940,
    37950,
    37960,
    37980,
    37990,
    38010,
    38020,
    38070,
    38090,
    38100,
    38120,
    38140,
    38150,
    38240,
    38270,
    38280,
    38290,
    38310,
    38320,
    38330,
    38350,
    38380,
    38390,
    38400,
    38410,
    38420,
    38440,
    38450,
    38460,
    38470,
    38480,
    38490,
    38510,
    38540,
    38560,
    38570,
    38580,
    38590,
    38610,
    38660,
    38670,
    38680,
    38690,
    38730,
    38740,
    38750,
    38760,
    38770,
    38780,
    38790,
    38800,
    38810,
    38840,
    38860,
    38880,
    38890,
    38900,
    38930,
    41190,
    41200,
    41400,
    41570,
    41580,
    41610,
    41640,
    41740,
    41750,
    41790,
    41800,
    41820,
    41830,
    41840,
    41860,
    41880,
    41890,
    41920,
    41990,
    44000,
    44010,
    44030,
    44090,
    44120,
    44180,
    44190,
    44290,
    44310,
    44320,
    44330,
    44340,
    44360,
    44370,
    44400,
    44410,
    44420,
    44430,
    44440,
    44450,
    44460,
    44470,
    44480,
    44490,
    44510,
    44520,
    44590,
    44600,
    44610,
    44650,
    44780,
    44790,
    44800,
    44810,
    44820,
    44830,
    44840,
    44850,
    44880,
    44890,
    44900,
    44910,
    44920,
    44930,
    44940,
    44950,
    44980,
    47020,
    47030,
    47040,
    47060,
    47070,
    47090,
    47110,
    47140,
    47150,
    47160,
    47170,
    47180,
    47270,
    47280,
    47290,
    47300,
    47310,
    47320,
    47340,
    47350,
    47360,
    47370,
    47380,
    47390,
    47400,
    47410,
    47420,
    47430,
    47440,
    47450,
    47460,
    47520,
    47530,
    47540,
    47550,
    47560,
    47570,
    47590,
    47600,
    47610,
    47620,
    47630,
    47640,
    47650,
    47660,
    47670,
    47680,
    47690,
    47700,
    47710,
    47740,
    47750,
    47800,
    47810,
    47830,
    47870,
    47910,
    47930,
    47980,
    47990,
    48000,
    48040,
    48060,
    48070,
    48080,
    48090,
    48140,
    48180,
    48200,
    48340,
    48350,
    48360,
    48410,
    48430,
    48440,
    48450,
    48460,
    48470,
    48480,
    48520,
    48530,
    48540,
    48550,
    48560,
    48570,
    48610,
    48620,
    48630,
    48640,
    48710,
    48740,
    48790,
    48810,
    48890,
    48900,
    48920,
    48930,
    48970,
    61020,
    61030,
    61050,
    61060,
    61070,
    61080,
    61090,
    61100,
    61110,
    61120,
    61130,
    61150,
    61180,
    61190,
    61200,
    61210,
    61220,
    61230,
    61240,
    61250,
    61260,
    61270,
    61280,
    61290,
    61300,
    61310,
    61320,
    61330,
    61340,
    61350,
    61360,
    61370,
    61380,
    61390,
    61400,
    61410,
    61420,
    61430,
    61440,
    61450,
    61460,
    61470,
    61480,
    61490,
    61500,
    61510,
    61530,
    61550,
    61560,
    61570,
    61650,
    61660,
    61700,
    61760,
    61770,
    61880,
    64010,
    64180,
    64190,
    64230,
    64270,
    64280,
    64300,
    64340,
    64350,
    64360,
    64410,
    64420,
    64450,
    64460,
    64470,
    64490,
    64500,
    64510,
    64520,
    64600,
    64630,
    64680,
    64690,
    64700,
    64730,
    64740,
    64750
  ];

var hairnew = Array();

function pushIfItemExists(array, itemid) {
    if ((itemid = cm.getCosmeticItem(itemid)) != -1 && !cm.isCosmeticEquipped(itemid)) {
        array.push(itemid);
    }
}

function start() {
    status = -1;
    action(1, 0, 0);
}

function action(mode, type, selection) {
    if (mode < 1) {  // disposing issue with stylishs found thanks to Vcoc
        cm.dispose();
    } else {
        if (mode == 1) {
            status++;
        } else {
            status--;
        }

        if (status == 0) {
            cm.sendSimple("嗨，我是 #p1012117#，周围最有魅力、最时尚的造型师。如果你正在寻找最好看的发型，那就别再找啦！使用#i5150044##r#t5150044##k来我这做发型吧！\r\n\r\n请从以下发型目录中选择一个查看：\r\n\#L0#1号发型目录#l\r\n\#L1#2号发型目录#l\r\n\#L2#3号发型目录#l\r\n\#L3#4号发型目录#l\r\n\#L4#5号发型目录#l\r\n\#L5#6号发型目录#l");
        } else if (status == 1) {
            hairnew = Array();
            if (cm.getPlayer().getGender() == 0) {
                for (var i = selection * 100; i < (selection === 5 ? mhair_v.length : ((selection + 1) * 100)); i++) {
                    pushIfItemExists(hairnew, mhair_v[i] + parseInt(cm.getPlayer().getHair() % 10));
                }
            } else {
                for (var i = selection * 100; i < (selection === 5 ? mhair_v.length : ((selection + 1) * 100)); i++) {
                    pushIfItemExists(hairnew, fhair_v[i] + parseInt(cm.getPlayer().getHair() % 10));
                }
            }

            cm.sendStyle("使用这张高级皇家理发券，你可以选择你想要的发型。挑选一个最让你满意的发型吧……", hairnew);
        } else if (status == 3) {
            if (cm.haveItem(5150044) == true) {
                cm.gainItem(5150044, -1);
                cm.setHair(hairnew[selection]);
                cm.sendOk("尽情享受你全新的时尚发型吧！");
            } else {
                cm.sendOk("嗯……看起来你没有我们指定的理发券……没有它我恐怕不能给你理发。很抱歉……");
                cm.dispose();
            }
        }
    }
}
